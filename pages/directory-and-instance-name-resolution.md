<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /pages/mdsource/directory-and-instance-name-resolution.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->
# Directory and Instance Name Resolution

The instance name is defined as:

<!-- snippet: GetInstanceName -->
```cs
if (scopeSuffix == null)
{
    return typeof(TDbContext).Name;
}

return $"{typeof(TDbContext).Name}_{scopeSuffix}";
```
<sup>[snippet source](/src/EfLocalDb/SqlInstance.cs#L131-L140)</sup>
<!-- endsnippet -->

That InstanceName is then used to derive the data directory. In order:

 * If `LocalDBData` environment variable exists then use `LocalDBData\InstanceName`.
 * If `AGENT_TEMPDIRECTORY` environment variable exists then use `AGENT_TEMPDIRECTORY\LocalDb\InstanceName`.
 * Use `%TempDir%\LocalDb\InstanceName`.

There is an explicit registration override that takes an instance name and a directory for that instance:


## For SQL:

<!-- snippet: RegisterExplicit -->
```cs
SqlInstanceService.Register(
    name: "theInstanceName",
    buildTemplate: TestDbBuilder.CreateTable,
    directory: @"C:\LocalDb\theInstance"
);
```
<sup>[snippet source](/src/LocalDb.Tests/Snippets/RegisterExplicit.cs#L7-L15)</sup>
<!-- endsnippet -->


## For EF:

<!-- snippet: EfRegisterExplicit -->
```cs
SqlInstanceService<TheDbContext>.Register(
    constructInstance: builder => new TheDbContext(builder.Options),
    instanceName: "theInstanceName",
    directory: @"C:\LocalDb\theInstance");
```
<sup>[snippet source](/src/EfLocalDb.Tests/Snippets/EfRegisterExplicit.cs#L7-L14)</sup>
<!-- endsnippet -->

